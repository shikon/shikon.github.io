<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Designing a Nixie HV supply part 1 - Shiko</title>
<meta name="description" content="Backstory  Well basically the backstory is the introduction but shht :). Recently I designed a small PCB with an analog switch for my internship project. This made me remember, I still have to finish my PCB I was doing for my nixie tube clock. Don’t know what those are? Well, here is an example:    I noticed that a huge area was taken by the high-voltage (HV) supply. It is a NCH6100HV, which I bought a couple years ago… The voltage is changeable by a potentiometer, great to experiment with. I was motivated to make it smaller but not only that. During the previous design process, I noticed creating your supplies is something any electronics project is needed. In my case I couldn’t use the very efficient switch-mode power supplies (SMPS) on my small analog switch PCB, as these typically have a lot of switching noise. They would be ideal as you can easily go up in voltage (boost) or down (buck). This made me intrigued but I couldn’t spend time to explore this. Well, during my New years break however, that means project time!  Interwebs, a gold mine  I remember few years ago reading about these supplies being made by hobbyist. So I re-googled these projects and they became a great resource for my nixie tube HV supply. I mainly used these resources:     de Smith focusses mainly on layout   Jan Rychter focusses on general design specifications   0x7d includes some general information about a few working principles of SMPS   Having scanned over these great projects it was time to dive into the theory.  Working principle of SMPS  The goal is to create a DC high-voltage supply from a lower voltage supply.  Just like climbing a mountain going up is a bit more difficult than going down. An example, a bad one however, is to create a lower voltage is using a so called voltage divider. If the load isn’t too heavy its fine but due to the fixed output impedance of the resistive ladder it will be easily disturbed by its load.   From wikipedia, here \(V_{out}=\frac{Z_2}{Z_1}V_{in}.\)  But the question was how to go up. Well the most common way to step up a DC voltage is to use a boost configuration and is in its simplest sense the following circuit.    The MOSFET acts as an on/off switch. Initially it is switched on, a certain current will set. When it is switched off, the current has less “way” to flow. The only path is to go through the diode and capacitor.  Basically the impedance to the right of the inductor has increased, the current want to decrease. However the inductor tries to counter this, the magnetic field it built up doesn’t want to change. It will increase the voltage to keep the current the same.  Ohm’s law with impedance (\(I = V/Z\)) tells, to keep I the same for larger Z we need to increase V. Indeed the constitutive relation of an inductor, \(V=-L\frac{\mathrm{d}I}{\mathrm{d}t}\), tells for decreasing current \(\frac{\mathrm{d}I}{\mathrm{d}t}&lt;0\) , there is a positive voltage, two voltage sources in series add up. This charges the capacitor to higher voltages than the input. In order to prevent the charge from flowing back -which is required to build a higher output voltage- a diode is required.  How do we determine the output voltage?  The output voltage is simple for continuous mode (CCM) and more complex when the converter is in discontinuous mode. Discontinuous mode (DCM) commonly occurs under light loads, as the current is low and quickly falls off to zero.  In CCM it is determined solely by the duty cycle (D&lt;1), \(V_{out}=\frac{V_{in}}{1-D}\). As said before in DCM, it is more complex and determined as well by the inductance, the load and switching frequency\(\left(V_{out}=\frac{1+\sqrt{1+\frac{4DR_{load}}{2Lf}}}{2}\right)\).  CCM VS DCM  Although DCM seems more complex, due to the feedback of DC-DC boost controllers, the design is actually easier. All you need to set the output, is to sense the output. For CCM you need to ensure the current through the inductor doesn’t fall to zero. However in DCM the inductor fully cycles in current levels and therefore leads to higher peak currents. These higher peak currents require higher component ratings, lead to decreased lifetime and power efficiency.  But first…  I didn’t want to repeat existing designs, that I could just copy from the internet or datasheets. I went out to research different topologies. You will find typically find the following DC-DC converter topologies.                 Topology       Characteristics       Advantage       Disadvantage                       Boost       Go up in voltage       most simple       efficiency by simplicity                 SEPIC       Go up and down in voltage       non-inverting       complexity                 Buck-boost       Go up and down in voltage       can go down in voltage       inverting                 Ćuk       Go up and down in voltage       continuous current       inverting           The Ćuk topology was intriguing as it could nicely operate in CCM mode, however it was inverting requiring even more components than boosts. The others only added going down in voltage which would be handy in applications which are for example battery powered. Here you start with larger voltage, this decreases over time and you need to switch from going down in voltage to going up. This then requires your topology to support both conversions.  But in my case this is unnecessary as it will be powered from a wall adapter and step up to very high voltages.  What then?  Well I don’t dislike reading papers so I just googled and came across so called charge pumps the research community really like these as these can have very high efficiencies and don’t require inductors such as in the boost topology. For more info on these click here. Sadly, this topology would require a lot of stages in order to boost 12 V to 180 V, although not a problem when doing an integrated design. I am building a PCB with discrete components and needing tens of capacitors is non-ideal.  Is all hope lost?  Do I have to settle with the regular boost topology? I guess. It is very simple and I like simple things, as even the simple things can turn out to be difficult. So Keep It Simple Stupid (KISS). The main element in boost converters is the inductor, there are typically 2 versions. The non-isolated (see Jan Rychter) and isolated version (0x7d). The isolated version uses an transformer and doing this has many advantages. It separates the input circuit and output circuit, however note that the ground is still common. But the intrinsic gain transformers can have is much more interesting for me. Since the power in these converter is going to be below 20 W. Those don’t really require galvanic isolation. The intrinsic gain relaxes various design parameters. The gain of the DC-DC converter is relaxed. Stepping up 12 V to 180 V requires a gain of 15 and this means in CCM mode requires a duty cycle of ~93%. This raises a few issues, boost controllers have a minimum on/off time, a minimum frequency and a maximum duty cycle. Lets have a look into this.  Math?!  Well yeah to do some good engineering, math always plays game. But that will be for part 2.">


  <meta name="author" content="Lan Hu">
  
  <meta property="article:author" content="Lan Hu">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Shiko">
<meta property="og:title" content="Designing a Nixie HV supply part 1">
<meta property="og:url" content="https://shiko.nl/electronics/a-pcb-design/">


  <meta property="og:description" content="Backstory  Well basically the backstory is the introduction but shht :). Recently I designed a small PCB with an analog switch for my internship project. This made me remember, I still have to finish my PCB I was doing for my nixie tube clock. Don’t know what those are? Well, here is an example:    I noticed that a huge area was taken by the high-voltage (HV) supply. It is a NCH6100HV, which I bought a couple years ago… The voltage is changeable by a potentiometer, great to experiment with. I was motivated to make it smaller but not only that. During the previous design process, I noticed creating your supplies is something any electronics project is needed. In my case I couldn’t use the very efficient switch-mode power supplies (SMPS) on my small analog switch PCB, as these typically have a lot of switching noise. They would be ideal as you can easily go up in voltage (boost) or down (buck). This made me intrigued but I couldn’t spend time to explore this. Well, during my New years break however, that means project time!  Interwebs, a gold mine  I remember few years ago reading about these supplies being made by hobbyist. So I re-googled these projects and they became a great resource for my nixie tube HV supply. I mainly used these resources:     de Smith focusses mainly on layout   Jan Rychter focusses on general design specifications   0x7d includes some general information about a few working principles of SMPS   Having scanned over these great projects it was time to dive into the theory.  Working principle of SMPS  The goal is to create a DC high-voltage supply from a lower voltage supply.  Just like climbing a mountain going up is a bit more difficult than going down. An example, a bad one however, is to create a lower voltage is using a so called voltage divider. If the load isn’t too heavy its fine but due to the fixed output impedance of the resistive ladder it will be easily disturbed by its load.   From wikipedia, here \(V_{out}=\frac{Z_2}{Z_1}V_{in}.\)  But the question was how to go up. Well the most common way to step up a DC voltage is to use a boost configuration and is in its simplest sense the following circuit.    The MOSFET acts as an on/off switch. Initially it is switched on, a certain current will set. When it is switched off, the current has less “way” to flow. The only path is to go through the diode and capacitor.  Basically the impedance to the right of the inductor has increased, the current want to decrease. However the inductor tries to counter this, the magnetic field it built up doesn’t want to change. It will increase the voltage to keep the current the same.  Ohm’s law with impedance (\(I = V/Z\)) tells, to keep I the same for larger Z we need to increase V. Indeed the constitutive relation of an inductor, \(V=-L\frac{\mathrm{d}I}{\mathrm{d}t}\), tells for decreasing current \(\frac{\mathrm{d}I}{\mathrm{d}t}&lt;0\) , there is a positive voltage, two voltage sources in series add up. This charges the capacitor to higher voltages than the input. In order to prevent the charge from flowing back -which is required to build a higher output voltage- a diode is required.  How do we determine the output voltage?  The output voltage is simple for continuous mode (CCM) and more complex when the converter is in discontinuous mode. Discontinuous mode (DCM) commonly occurs under light loads, as the current is low and quickly falls off to zero.  In CCM it is determined solely by the duty cycle (D&lt;1), \(V_{out}=\frac{V_{in}}{1-D}\). As said before in DCM, it is more complex and determined as well by the inductance, the load and switching frequency\(\left(V_{out}=\frac{1+\sqrt{1+\frac{4DR_{load}}{2Lf}}}{2}\right)\).  CCM VS DCM  Although DCM seems more complex, due to the feedback of DC-DC boost controllers, the design is actually easier. All you need to set the output, is to sense the output. For CCM you need to ensure the current through the inductor doesn’t fall to zero. However in DCM the inductor fully cycles in current levels and therefore leads to higher peak currents. These higher peak currents require higher component ratings, lead to decreased lifetime and power efficiency.  But first…  I didn’t want to repeat existing designs, that I could just copy from the internet or datasheets. I went out to research different topologies. You will find typically find the following DC-DC converter topologies.                 Topology       Characteristics       Advantage       Disadvantage                       Boost       Go up in voltage       most simple       efficiency by simplicity                 SEPIC       Go up and down in voltage       non-inverting       complexity                 Buck-boost       Go up and down in voltage       can go down in voltage       inverting                 Ćuk       Go up and down in voltage       continuous current       inverting           The Ćuk topology was intriguing as it could nicely operate in CCM mode, however it was inverting requiring even more components than boosts. The others only added going down in voltage which would be handy in applications which are for example battery powered. Here you start with larger voltage, this decreases over time and you need to switch from going down in voltage to going up. This then requires your topology to support both conversions.  But in my case this is unnecessary as it will be powered from a wall adapter and step up to very high voltages.  What then?  Well I don’t dislike reading papers so I just googled and came across so called charge pumps the research community really like these as these can have very high efficiencies and don’t require inductors such as in the boost topology. For more info on these click here. Sadly, this topology would require a lot of stages in order to boost 12 V to 180 V, although not a problem when doing an integrated design. I am building a PCB with discrete components and needing tens of capacitors is non-ideal.  Is all hope lost?  Do I have to settle with the regular boost topology? I guess. It is very simple and I like simple things, as even the simple things can turn out to be difficult. So Keep It Simple Stupid (KISS). The main element in boost converters is the inductor, there are typically 2 versions. The non-isolated (see Jan Rychter) and isolated version (0x7d). The isolated version uses an transformer and doing this has many advantages. It separates the input circuit and output circuit, however note that the ground is still common. But the intrinsic gain transformers can have is much more interesting for me. Since the power in these converter is going to be below 20 W. Those don’t really require galvanic isolation. The intrinsic gain relaxes various design parameters. The gain of the DC-DC converter is relaxed. Stepping up 12 V to 180 V requires a gain of 15 and this means in CCM mode requires a duty cycle of ~93%. This raises a few issues, boost controllers have a minimum on/off time, a minimum frequency and a maximum duty cycle. Lets have a look into this.  Math?!  Well yeah to do some good engineering, math always plays game. But that will be for part 2.">



  <meta property="og:image" content="https://shiko.nl/assets/images/site-logo.png">





  <meta property="article:published_time" content="2021-01-02T00:00:00+01:00">



  <meta property="article:modified_time" content="2021-01-09T16:00:23+01:00">



  

  


<link rel="canonical" href="https://shiko.nl/electronics/a-pcb-design/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Lan Hu",
      "url": "https://shiko.nl/",
      "sameAs": ["https://github.com/shikon"]
    
  }
</script>


  <meta name="google-site-verification" content="UQj93ERU9zgECodaaXgVpkjrFn9UrDMEzVamacSoQ8Y" />






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Shiko Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/images/favicons/site.webmanifest">
<link rel="mask-icon" href="/assets/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/assets/images/favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/images/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/logo.png" alt="Shiko"></a>
        
        <a class="site-title" href="/">
          Shiko
          <span class="site-subtitle">Life is an unique journey</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/me.jpg" alt="Lan Hu" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Lan Hu</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>A student of life, multi-faceted, tries to master his trades.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Noord-Brabant, NL</span>
        </li>
      

      
        
          
            <li><a href="mailto:lan@shiko.nl" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://github.com/shikon" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/lanhu" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">Linkedin</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Designing a Nixie HV supply part 1">
    <meta itemprop="description" content="BackstoryWell basically the backstory is the introduction but shht :). Recently I designed a small PCB with an analog switch for my internship project. This made me remember, I still have to finish my PCB I was doing for my nixie tube clock. Don’t know what those are? Well, here is an example:I noticed that a huge area was taken by the high-voltage (HV) supply. It is a NCH6100HV, which I bought a couple years ago… The voltage is changeable by a potentiometer, great to experiment with. I was motivated to make it smaller but not only that. During the previous design process, I noticed creating your supplies is something any electronics project is needed. In my case I couldn’t use the very efficient switch-mode power supplies (SMPS) on my small analog switch PCB, as these typically have a lot of switching noise. They would be ideal as you can easily go up in voltage (boost) or down (buck). This made me intrigued but I couldn’t spend time to explore this. Well, during my New years break however, that means project time!Interwebs, a gold mineI remember few years ago reading about these supplies being made by hobbyist. So I re-googled these projects and they became a great resource for my nixie tube HV supply. I mainly used these resources:  de Smith focusses mainly on layout  Jan Rychter focusses on general design specifications  0x7d includes some general information about a few working principles of SMPSHaving scanned over these great projects it was time to dive into the theory.Working principle of SMPSThe goal is to create a DC high-voltage supply from a lower voltage supply.  Just like climbing a mountain going up is a bit more difficult than going down. An example, a bad one however, is to create a lower voltage is using a so called voltage divider. If the load isn’t too heavy its fine but due to the fixed output impedance of the resistive ladder it will be easily disturbed by its load.From wikipedia, here \(V_{out}=\frac{Z_2}{Z_1}V_{in}.\)But the question was how to go up. Well the most common way to step up a DC voltage is to use a boost configuration and is in its simplest sense the following circuit.The MOSFET acts as an on/off switch. Initially it is switched on, a certain current will set. When it is switched off, the current has less “way” to flow. The only path is to go through the diode and capacitor.  Basically the impedance to the right of the inductor has increased, the current want to decrease. However the inductor tries to counter this, the magnetic field it built up doesn’t want to change. It will increase the voltage to keep the current the same.  Ohm’s law with impedance (\(I = V/Z\)) tells, to keep I the same for larger Z we need to increase V. Indeed the constitutive relation of an inductor, \(V=-L\frac{\mathrm{d}I}{\mathrm{d}t}\), tells for decreasing current \(\frac{\mathrm{d}I}{\mathrm{d}t}&lt;0\) , there is a positive voltage, two voltage sources in series add up. This charges the capacitor to higher voltages than the input. In order to prevent the charge from flowing back -which is required to build a higher output voltage- a diode is required.How do we determine the output voltage?The output voltage is simple for continuous mode (CCM) and more complex when the converter is in discontinuous mode. Discontinuous mode (DCM) commonly occurs under light loads, as the current is low and quickly falls off to zero.  In CCM it is determined solely by the duty cycle (D&lt;1), \(V_{out}=\frac{V_{in}}{1-D}\). As said before in DCM, it is more complex and determined as well by the inductance, the load and switching frequency\(\left(V_{out}=\frac{1+\sqrt{1+\frac{4DR_{load}}{2Lf}}}{2}\right)\).CCM VS DCMAlthough DCM seems more complex, due to the feedback of DC-DC boost controllers, the design is actually easier. All you need to set the output, is to sense the output. For CCM you need to ensure the current through the inductor doesn’t fall to zero. However in DCM the inductor fully cycles in current levels and therefore leads to higher peak currents. These higher peak currents require higher component ratings, lead to decreased lifetime and power efficiency.But first…I didn’t want to repeat existing designs, that I could just copy from the internet or datasheets. I went out to research different topologies. You will find typically find the following DC-DC converter topologies.            Topology      Characteristics      Advantage      Disadvantage                  Boost      Go up in voltage      most simple      efficiency by simplicity              SEPIC      Go up and down in voltage      non-inverting      complexity              Buck-boost      Go up and down in voltage      can go down in voltage      inverting              Ćuk      Go up and down in voltage      continuous current      inverting      The Ćuk topology was intriguing as it could nicely operate in CCM mode, however it was inverting requiring even more components than boosts. The others only added going down in voltage which would be handy in applications which are for example battery powered. Here you start with larger voltage, this decreases over time and you need to switch from going down in voltage to going up. This then requires your topology to support both conversions.  But in my case this is unnecessary as it will be powered from a wall adapter and step up to very high voltages.What then?Well I don’t dislike reading papers so I just googled and came across so called charge pumps the research community really like these as these can have very high efficiencies and don’t require inductors such as in the boost topology. For more info on these click here. Sadly, this topology would require a lot of stages in order to boost 12 V to 180 V, although not a problem when doing an integrated design. I am building a PCB with discrete components and needing tens of capacitors is non-ideal.Is all hope lost?Do I have to settle with the regular boost topology? I guess. It is very simple and I like simple things, as even the simple things can turn out to be difficult. So Keep It Simple Stupid (KISS). The main element in boost converters is the inductor, there are typically 2 versions. The non-isolated (see Jan Rychter) and isolated version (0x7d). The isolated version uses an transformer and doing this has many advantages. It separates the input circuit and output circuit, however note that the ground is still common. But the intrinsic gain transformers can have is much more interesting for me. Since the power in these converter is going to be below 20 W. Those don’t really require galvanic isolation. The intrinsic gain relaxes various design parameters. The gain of the DC-DC converter is relaxed. Stepping up 12 V to 180 V requires a gain of 15 and this means in CCM mode requires a duty cycle of ~93%. This raises a few issues, boost controllers have a minimum on/off time, a minimum frequency and a maximum duty cycle. Lets have a look into this.Math?!Well yeah to do some good engineering, math always plays game. But that will be for part 2.">
    <meta itemprop="datePublished" content="2021-01-02T00:00:00+01:00">
    <meta itemprop="dateModified" content="2021-01-09T16:00:23+01:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Designing a Nixie HV supply part 1
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#backstory">Backstory</a></li><li><a href="#interwebs-a-gold-mine">Interwebs, a gold mine</a><ul><li><a href="#working-principle-of-smps">Working principle of SMPS</a></li><li><a href="#how-do-we-determine-the-output-voltage">How do we determine the output voltage?</a></li><li><a href="#ccm-vs-dcm">CCM VS DCM</a></li></ul></li><li><a href="#but-first">But first…</a><ul><li><a href="#what-then">What then?</a></li><li><a href="#is-all-hope-lost">Is all hope lost?</a></li></ul></li><li><a href="#math">Math?!</a></li></ul>

            </nav>
          </aside>
        
        <h1 id="backstory">Backstory</h1>

<p>Well basically the backstory is the introduction but shht :). Recently I designed a small PCB with an analog switch for my internship project. This made me remember, I still have to finish my PCB I was doing for my nixie tube clock. Don’t know what those are? Well, here is an example:</p>

<p><img src="https://raw.githubusercontent.com/shikon/cloudimg/master/typora/xclock_small.jpg.pagespeed.ic.5qBb-pWZkY.webp" alt="Meinbergnews" /></p>

<p>I noticed that a huge area was taken by the high-voltage (HV) supply. It is a NCH6100HV, which I bought a couple years ago… The voltage is changeable by a potentiometer, great to experiment with. I was motivated to make it smaller but not only that. During the previous design process, I noticed creating your supplies is something any electronics project is needed. In my case I couldn’t use the very efficient switch-mode power supplies (SMPS) on my small analog switch PCB, as these typically have a lot of switching noise. They would be ideal as you can easily go up in voltage (boost) or down (buck). This made me intrigued but I couldn’t spend time to explore this. Well, during my New years break however, that means project time!</p>

<h1 id="interwebs-a-gold-mine">Interwebs, a gold mine</h1>

<p>I remember few years ago reading about these supplies being made by hobbyist. So I re-googled these projects and they became a great resource for my nixie tube HV supply. I mainly used these resources:</p>

<ul>
  <li><a href="https://desmith.net/NMdS/Electronics/NixiePSU.html">de Smith</a> focusses mainly on layout</li>
  <li><a href="https://jan.rychter.com/high-voltage-power-supply-for-nixie-tube-projects">Jan Rychter</a> focusses on general design specifications</li>
  <li><a href="https://0x7d.com/2017/nixie-tube-clock/#Custom_Power_Supply">0x7d</a> includes some general information about a few working principles of SMPS</li>
</ul>

<p>Having scanned over these great projects it was time to dive into the theory.</p>

<h2 id="working-principle-of-smps">Working principle of SMPS</h2>

<p>The goal is to create a DC high-voltage supply from a lower voltage supply.  Just like climbing a mountain going up is a bit more difficult than going down. An example, a bad one however, is to create a lower voltage is using a so called voltage divider. If the load isn’t too heavy its fine but due to the fixed output impedance of the resistive ladder it will be easily disturbed by its load.</p>

<p><img src="https://raw.githubusercontent.com/shikon/cloudimg/master/typora/330px-Impedance_voltage_divider.svg.png" alt="Wikipedia" />
<em>From <a href="https://en.wikipedia.org/wiki/Voltage_divider">wikipedia</a>, here \(V_{out}=\frac{Z_2}{Z_1}V_{in}.\)</em></p>

<p>But the question was how to go up. Well the most common way to step up a DC voltage is to use a boost configuration and is in its simplest sense the following circuit.</p>

<p><img src="https://raw.githubusercontent.com/shikon/cloudimg/master/typora/boost_circuit_v2.png" alt="" /></p>

<p>The MOSFET acts as an on/off switch. Initially it is switched on, a certain current will set. When it is switched off, the current has less “way” to flow. The only path is to go through the diode and capacitor.  Basically the impedance to the right of the inductor has increased, the current want to decrease. However the inductor tries to counter this, the magnetic field it built up doesn’t want to change. It will increase the voltage to keep the current the same.  Ohm’s law with impedance (\(I = V/Z\)) tells, to keep I the same for larger Z we need to increase V. Indeed the constitutive relation of an inductor, \(V=-L\frac{\mathrm{d}I}{\mathrm{d}t}\), tells for decreasing current \(\frac{\mathrm{d}I}{\mathrm{d}t}&lt;0\) , there is a positive voltage, two voltage sources in series add up. This charges the capacitor to higher voltages than the input. In order to prevent the charge from flowing back -which is required to build a higher output voltage- a diode is required.</p>

<h2 id="how-do-we-determine-the-output-voltage">How do we determine the output voltage?</h2>

<p>The output voltage is simple for continuous mode (CCM) and more complex when the converter is in discontinuous mode. Discontinuous mode (DCM) commonly occurs under light loads, as the current is low and quickly falls off to zero.  In CCM it is determined solely by the duty cycle (D&lt;1), \(V_{out}=\frac{V_{in}}{1-D}\). As said before in DCM, it is more complex and determined as well by the inductance, the load and switching frequency\(\left(V_{out}=\frac{1+\sqrt{1+\frac{4DR_{load}}{2Lf}}}{2}\right)\).</p>

<h2 id="ccm-vs-dcm">CCM VS DCM</h2>

<p>Although DCM seems more complex, due to the feedback of DC-DC boost controllers, the design is actually easier. All you need to set the output, is to sense the output. For CCM you need to ensure the current through the inductor doesn’t fall to zero. However in DCM the inductor fully cycles in current levels and therefore leads to higher peak currents. These higher peak currents require higher component ratings, lead to decreased lifetime and power efficiency.</p>

<h1 id="but-first">But first…</h1>

<p>I didn’t want to repeat existing designs, that I could just copy from the internet or datasheets. I went out to research different topologies. You will find typically find the following DC-DC converter topologies.</p>

<table>
  <thead>
    <tr>
      <th>Topology</th>
      <th>Characteristics</th>
      <th>Advantage</th>
      <th>Disadvantage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Boost</td>
      <td>Go up in voltage</td>
      <td>most simple</td>
      <td>efficiency by simplicity</td>
    </tr>
    <tr>
      <td>SEPIC</td>
      <td>Go up and down in voltage</td>
      <td>non-inverting</td>
      <td>complexity</td>
    </tr>
    <tr>
      <td>Buck-boost</td>
      <td>Go up and down in voltage</td>
      <td>can go down in voltage</td>
      <td>inverting</td>
    </tr>
    <tr>
      <td>Ćuk</td>
      <td>Go up and down in voltage</td>
      <td>continuous current</td>
      <td>inverting</td>
    </tr>
  </tbody>
</table>

<p>The Ćuk topology was intriguing as it could nicely operate in CCM mode, however it was inverting requiring even more components than boosts. The others only added going down in voltage which would be handy in applications which are for example battery powered. Here you start with larger voltage, this decreases over time and you need to switch from going down in voltage to going up. This then requires your topology to support both conversions.  But in my case this is unnecessary as it will be powered from a wall adapter and step up to very high voltages.</p>

<h2 id="what-then">What then?</h2>

<p>Well I don’t dislike reading papers so I just googled and came across so called <em>charge pumps</em> the research community really like these as these can have very high efficiencies and don’t require inductors such as in the boost topology. <a href="https://ieeexplore.ieee.org/document/1624399">For more info on these click here.</a> Sadly, this topology would require a lot of stages in order to boost 12 V to 180 V, although not a problem when doing an integrated design. I am building a PCB with discrete components and needing tens of capacitors is non-ideal.</p>

<h2 id="is-all-hope-lost">Is all hope lost?</h2>

<p>Do I have to settle with the regular boost topology? I guess. It is very simple and I like simple things, as even the simple things can turn out to be difficult. So Keep It Simple Stupid (KISS). The main element in boost converters is the inductor, there are typically 2 versions. The non-isolated (<a href="https://jan.rychter.com/high-voltage-power-supply-for-nixie-tube-projects">see Jan Rychter</a>) and isolated version (<a href="https://0x7d.com/2017/nixie-tube-clock/#Custom_Power_Supply">0x7d</a>). The isolated version uses an transformer and doing this has many advantages. It separates the input circuit and output circuit, however note that the ground is still common. But the intrinsic gain transformers can have is much more interesting for me. Since the power in these converter is going to be below 20 W. Those don’t really require galvanic isolation. The intrinsic gain relaxes various design parameters. The gain of the DC-DC converter is relaxed. Stepping up 12 V to 180 V requires a gain of 15 and this means in CCM mode requires a duty cycle of ~93%. This raises a few issues, boost controllers have a minimum on/off time, a minimum frequency and a maximum duty cycle. Lets have a look into this.</p>

<h1 id="math">Math?!</h1>

<p>Well yeah to do some good engineering, math always plays game. But that will be for part 2.</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#cad" class="page__taxonomy-item" rel="tag">CAD</a><span class="sep">, </span>
    
      <a href="/tags/#design" class="page__taxonomy-item" rel="tag">design</a><span class="sep">, </span>
    
      <a href="/tags/#pcb" class="page__taxonomy-item" rel="tag">PCB</a><span class="sep">, </span>
    
      <a href="/tags/#project" class="page__taxonomy-item" rel="tag">project</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#electronics" class="page__taxonomy-item" rel="tag">electronics</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-01-09">January 9, 2021</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=Designing+a+Nixie+HV+supply+part+1%20https%3A%2F%2Fshiko.nl%2Felectronics%2Fa-pcb-design%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fshiko.nl%2Felectronics%2Fa-pcb-design%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fshiko.nl%2Felectronics%2Fa-pcb-design%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/3d-printing/drawing-orings/" class="pagination--pager" title="Drawing O-rings for dad aka printing O-rings for dad part 2
">Previous</a>
    
    
      <a href="/programming/automating_jekyll/" class="pagination--pager" title="Automating jekyll build and github hosting
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comments</h4>
      <section id="giscus-comments"></section>
    
</div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/life/review/cgm_sinocare/" rel="permalink">Review: Sinocare continuous glucose monitor
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Why a Continuous Glucose Monitor (CGM)?

Even as someone who does not suffer from diabetes, knowing your glucose is a good way to learn your body.
Every body...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/growth/travel/why_now/" rel="permalink">Why Now? The Question That Unlocked My Journey to Purpose
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Unlocking My Ikigai: Could It Be More than Just “Feeling Good”?

Ever stop and wonder, “What’s the point of it all?” Lately, I’ve been grappling with that qu...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/website/enabling_comments/" rel="permalink">Enabling comments
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Being social to connect and grow
Enabling comments has been for over a year on my to do list, but I never got to it.
The need wasn’t very high as I didn’t ge...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/travel/competition_islands/" rel="permalink">Island Harmony: Exploring Challenges and Creativity in Limited Competition
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Discovering Harmonies: A Stroll Through Madeira’s Musical Christmas
As I strolled through the heart of Madeira’s city center, the melodic strains of the isla...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="search-searchbar"></div>
  <div class="search-hits"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://github.com/shikon" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/lanhu" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> Linkedin</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 Lan Hu. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>


<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch-theme-algolia.min.css">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  appId: 'L6XIHWOGZ2',
  apiKey: '43db23cbf486a7a95d34883d3391bdab',
  indexName: 'blog',
  searchParameters: {
    restrictSearchableAttributes: [
      'title',
      'content'
    ]
  }
});

const hitTemplate = function(hit) {
  const url = hit.url;
  const title = hit._highlightResult.title.value;
  const content = hit._highlightResult.html.value;

  return `
    <div class="list__item">
      <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
        <h2 class="archive__item-title" itemprop="headline"><a href="${url}">${title}</a></h2>
        <div class="archive__item-excerpt" itemprop="description">${content}</div>
      </article>
    </div>
  `;
}

// Adding searchbar and results widgets
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '.search-searchbar',
    poweredBy: true,
    placeholder: 'Enter your search term...'
  })
);
search.addWidget(
  instantsearch.widgets.hits({
    container: '.search-hits',
    templates: {
      item: hitTemplate,
      empty: 'No results',
    }
  })
);

// Starting the search only when toggle is clicked
$(document).ready(function () {
  $(".search__toggle").on("click", function() {
    if(!search.started) {
      search.start();
    }
  });
});
</script>





  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-36ZR2R12VX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-36ZR2R12VX', { 'anonymize_ip': true});
</script>






    <script>
  'use strict';

  (function () {
    var commentContainer = document.querySelector('#giscus-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://giscus.app/client.js');
    script.setAttribute('data-repo', 'shikon/shikon.github.io');
    script.setAttribute('data-repo-id', 'MDEwOlJlcG9zaXRvcnkzMjQ2NzYxMTE=');
    script.setAttribute('data-category', 'Announcements');
    script.setAttribute('data-category-id', 'DIC_kwDOE1oqD84CcMt6');
    script.setAttribute('data-mapping', 'pathname');
    script.setAttribute('data-reactions-enabled', '1');
    script.setAttribute('data-theme', 'light');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>
  




<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" defer
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>


  </body>
</html>
