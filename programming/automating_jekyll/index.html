<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Automating jekyll build and github hosting - Shiko</title>
<meta name="description" content="Backstory  As people might have noticed this website runs on jekyll, which is code that creates static websites. Great for my simple blogging use. The easiest way for me to get this nice skin working on github pages was to use their remote theme function. However, letting github compile the website leads to some limitation such as plugin use. In order to futureproof myself (files come and go…) I would rather compile it locally and make only use of github’s free hosting.  Googling a solution  Google is my friend, apparently people compile Jekyll locally, mainly for unsupported plugin.  Therefore I searched using the following keywords “Jekyll static github pages with unsupported plugins” and came along Dani’s nice write-up. Unfortunately, his method on how to update the website didn’t work for me, and is probably due to the lack of my understanding of how git works. I did follow the preceding steps in his guide.  However this lead me to a much better solution which automates a great deal and makes it as easy as a single push of a button ;).  Browsing the internet a bit more I came across Surdu’s script, which made life easier.  Working out the details  The goal is to enable static webpage hosting on github. And also try to make this as effortless possible.  That is so I can focus my time on my projects and not the nitty gritty.  At the end you will have achieved the following.     Keep files in 1 repository, this makes sense as they belong together   Store website files in the branch “head”, as github will interpret this to the website files under yourname.github.io   Store source files in the branch “source”   Pushing your new posts will recompile the website and update your webpage accordingly   I will assume you understand:     Basics of git, at least how to set it. Such you can send git commands in the terminal   Have jekyll already installed and working. If not see for example this.   Basic use of unix   Use the bundle command to compile your jekyll website   Separating by branching  In order for github to correctly interpret your files.  We should push the compiled files (defaults to _site -inside-) to our head branch. All other files are pushed to our source branch. To achieve this do the following. In your repository folder which is also the main jekyll folder now root,     Put _site/ in the .gitignore file   git checkout source, push and git checkout master. Compile the website bundle exec jekyll build.   cd _site and touch .nojekyll this prevents github to compile   Go back to root, backup all files and remove everything inside except the .gitignore file.   Copy everything inside _site -which you backed up- to root and push. Delete _site.   git checkout sources and copy everything back (not _site, should be removed) and push. Now github will display your locally compiled website. While your source files are inside the source branch.   ‘*’ a push entails, easily,  git add . git commit -m &#39;commit message&#39; git push   Script for updating  The complex workflow noted by Dani didn’t work out and I am lazy. So we are going to automate the flow of updating the website and updating our branches accordingly. This script is based on Surdu’s script, but first.          Create a file “pre-push” nano root/.git/hooks/pre-push           With the following content      #!/bin/sh # This script assumes the master branch is the website therefore all compiled files should be in master branch # the source branch holds all your files, please put &lt;_site/&gt; in your git.ignore file     # If any command fails in the below script, exit with error set -e     # Set the name of the folder that will be created in the parent # folder of your repo folder, and which will temporarily # hold the generated content. temp_folder=&quot;_source-temp&quot;     # Make sure our main code runs only if we push the master branch if [ &quot;$(git rev-parse --symbolic-full-name --abbrev-ref HEAD)&quot; == &quot;source&quot; ]; then 	# Store the last commit message from source branch 	last_message=$(git show -s --format=%s source)     	# Build our Jekyll site 	bundle exec jekyll build     	# Move the generated site in our temp folder 	mv _site ../${temp_folder}     	# Checkout the gh-pages branch and clean it&#39;s contents 	git checkout master 	rm -rf *     	# Copy the site content from the temp folder and remove the temp folder 	cp -r ../${temp_folder}/* . 	rm -rf ../${temp_folder}     	# Commit and push our generated site to GitHub 	git add -A 	git commit -m &quot;Built \`$last_message\`&quot; 	git push     	# Go back to the source branch 	git checkout source else 	echo &quot;Not source branch. Skipping build&quot; fi                    chmod +x root/.git/hooks/pre-push           Add your new files and recompile by doing a push in root.      End  If anything is unclear or not working don’t hesitate to leave a comment (if it works).">


  <meta name="author" content="Lan Hu">
  
  <meta property="article:author" content="Lan Hu">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Shiko">
<meta property="og:title" content="Automating jekyll build and github hosting">
<meta property="og:url" content="https://shiko.nl/programming/automating_jekyll/">


  <meta property="og:description" content="Backstory  As people might have noticed this website runs on jekyll, which is code that creates static websites. Great for my simple blogging use. The easiest way for me to get this nice skin working on github pages was to use their remote theme function. However, letting github compile the website leads to some limitation such as plugin use. In order to futureproof myself (files come and go…) I would rather compile it locally and make only use of github’s free hosting.  Googling a solution  Google is my friend, apparently people compile Jekyll locally, mainly for unsupported plugin.  Therefore I searched using the following keywords “Jekyll static github pages with unsupported plugins” and came along Dani’s nice write-up. Unfortunately, his method on how to update the website didn’t work for me, and is probably due to the lack of my understanding of how git works. I did follow the preceding steps in his guide.  However this lead me to a much better solution which automates a great deal and makes it as easy as a single push of a button ;).  Browsing the internet a bit more I came across Surdu’s script, which made life easier.  Working out the details  The goal is to enable static webpage hosting on github. And also try to make this as effortless possible.  That is so I can focus my time on my projects and not the nitty gritty.  At the end you will have achieved the following.     Keep files in 1 repository, this makes sense as they belong together   Store website files in the branch “head”, as github will interpret this to the website files under yourname.github.io   Store source files in the branch “source”   Pushing your new posts will recompile the website and update your webpage accordingly   I will assume you understand:     Basics of git, at least how to set it. Such you can send git commands in the terminal   Have jekyll already installed and working. If not see for example this.   Basic use of unix   Use the bundle command to compile your jekyll website   Separating by branching  In order for github to correctly interpret your files.  We should push the compiled files (defaults to _site -inside-) to our head branch. All other files are pushed to our source branch. To achieve this do the following. In your repository folder which is also the main jekyll folder now root,     Put _site/ in the .gitignore file   git checkout source, push and git checkout master. Compile the website bundle exec jekyll build.   cd _site and touch .nojekyll this prevents github to compile   Go back to root, backup all files and remove everything inside except the .gitignore file.   Copy everything inside _site -which you backed up- to root and push. Delete _site.   git checkout sources and copy everything back (not _site, should be removed) and push. Now github will display your locally compiled website. While your source files are inside the source branch.   ‘*’ a push entails, easily,  git add . git commit -m &#39;commit message&#39; git push   Script for updating  The complex workflow noted by Dani didn’t work out and I am lazy. So we are going to automate the flow of updating the website and updating our branches accordingly. This script is based on Surdu’s script, but first.          Create a file “pre-push” nano root/.git/hooks/pre-push           With the following content      #!/bin/sh # This script assumes the master branch is the website therefore all compiled files should be in master branch # the source branch holds all your files, please put &lt;_site/&gt; in your git.ignore file     # If any command fails in the below script, exit with error set -e     # Set the name of the folder that will be created in the parent # folder of your repo folder, and which will temporarily # hold the generated content. temp_folder=&quot;_source-temp&quot;     # Make sure our main code runs only if we push the master branch if [ &quot;$(git rev-parse --symbolic-full-name --abbrev-ref HEAD)&quot; == &quot;source&quot; ]; then 	# Store the last commit message from source branch 	last_message=$(git show -s --format=%s source)     	# Build our Jekyll site 	bundle exec jekyll build     	# Move the generated site in our temp folder 	mv _site ../${temp_folder}     	# Checkout the gh-pages branch and clean it&#39;s contents 	git checkout master 	rm -rf *     	# Copy the site content from the temp folder and remove the temp folder 	cp -r ../${temp_folder}/* . 	rm -rf ../${temp_folder}     	# Commit and push our generated site to GitHub 	git add -A 	git commit -m &quot;Built \`$last_message\`&quot; 	git push     	# Go back to the source branch 	git checkout source else 	echo &quot;Not source branch. Skipping build&quot; fi                    chmod +x root/.git/hooks/pre-push           Add your new files and recompile by doing a push in root.      End  If anything is unclear or not working don’t hesitate to leave a comment (if it works).">



  <meta property="og:image" content="https://shiko.nl/assets/images/site-logo.png">





  <meta property="article:published_time" content="2021-01-24T00:00:00+01:00">





  

  


<link rel="canonical" href="https://shiko.nl/programming/automating_jekyll/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Lan Hu",
      "url": "https://shiko.nl/",
      "sameAs": ["https://twitter.com/mmistakes","https://www.facebook.com/michaelrose"]
    
  }
</script>


  <meta name="google-site-verification" content="UQj93ERU9zgECodaaXgVpkjrFn9UrDMEzVamacSoQ8Y" />






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Shiko Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/images/favicons/site.webmanifest">
<link rel="mask-icon" href="/assets/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/assets/images/favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/images/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/logo.png" alt="Shiko"></a>
        
        <a class="site-title" href="/">
          Shiko
          <span class="site-subtitle">Life is an unique journey</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/me.jpg" alt="Lan Hu" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Lan Hu</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>A student of life, multi-faceted, tries to master his trades.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Noord-Brabant, NL</span>
        </li>
      

      
        
          
            <li><a href="mailto:lan@shiko.nl" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://github.com/shikon" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/lanhu" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">Linkedin</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Automating jekyll build and github hosting">
    <meta itemprop="description" content="BackstoryAs people might have noticed this website runs on jekyll, which is code that creates static websites. Great for my simple blogging use. The easiest way for me to get this nice skin working on github pages was to use their remote theme function. However, letting github compile the website leads to some limitation such as plugin use. In order to futureproof myself (files come and go…) I would rather compile it locally and make only use of github’s free hosting.Googling a solutionGoogle is my friend, apparently people compile Jekyll locally, mainly for unsupported plugin.  Therefore I searched using the following keywords “Jekyll static github pages with unsupported plugins” and came along Dani’s nice write-up. Unfortunately, his method on how to update the website didn’t work for me, and is probably due to the lack of my understanding of how git works. I did follow the preceding steps in his guide.  However this lead me to a much better solution which automates a great deal and makes it as easy as a single push of a button ;).  Browsing the internet a bit more I came across Surdu’s script, which made life easier.Working out the detailsThe goal is to enable static webpage hosting on github. And also try to make this as effortless possible.  That is so I can focus my time on my projects and not the nitty gritty.At the end you will have achieved the following.  Keep files in 1 repository, this makes sense as they belong together  Store website files in the branch “head”, as github will interpret this to the website files under yourname.github.io  Store source files in the branch “source”  Pushing your new posts will recompile the website and update your webpage accordinglyI will assume you understand:  Basics of git, at least how to set it. Such you can send git commands in the terminal  Have jekyll already installed and working. If not see for example this.  Basic use of unix  Use the bundle command to compile your jekyll websiteSeparating by branchingIn order for github to correctly interpret your files.  We should push the compiled files (defaults to _site -inside-) to our head branch. All other files are pushed to our source branch. To achieve this do the following. In your repository folder which is also the main jekyll folder now root,  Put _site/ in the .gitignore file  git checkout source, push and git checkout master. Compile the website bundle exec jekyll build.  cd _site and touch .nojekyll this prevents github to compile  Go back to root, backup all files and remove everything inside except the .gitignore file.  Copy everything inside _site -which you backed up- to root and push. Delete _site.  git checkout sources and copy everything back (not _site, should be removed) and push. Now github will display your locally compiled website. While your source files are inside the source branch.‘*’ a push entails, easily,git add .git commit -m &#39;commit message&#39;git pushScript for updatingThe complex workflow noted by Dani didn’t work out and I am lazy. So we are going to automate the flow of updating the website and updating our branches accordingly. This script is based on Surdu’s script, but first.      Create a file “pre-push” nano root/.git/hooks/pre-push        With the following content    #!/bin/sh# This script assumes the master branch is the website therefore all compiled files should be in master branch# the source branch holds all your files, please put &lt;_site/&gt; in your git.ignore file   # If any command fails in the below script, exit with errorset -e   # Set the name of the folder that will be created in the parent# folder of your repo folder, and which will temporarily# hold the generated content.temp_folder=&quot;_source-temp&quot;   # Make sure our main code runs only if we push the master branchif [ &quot;$(git rev-parse --symbolic-full-name --abbrev-ref HEAD)&quot; == &quot;source&quot; ]; then	# Store the last commit message from source branch	last_message=$(git show -s --format=%s source)   	# Build our Jekyll site	bundle exec jekyll build   	# Move the generated site in our temp folder	mv _site ../${temp_folder}   	# Checkout the gh-pages branch and clean it&#39;s contents	git checkout master	rm -rf *   	# Copy the site content from the temp folder and remove the temp folder	cp -r ../${temp_folder}/* .	rm -rf ../${temp_folder}   	# Commit and push our generated site to GitHub	git add -A	git commit -m &quot;Built \`$last_message\`&quot;	git push   	# Go back to the source branch	git checkout sourceelse	echo &quot;Not source branch. Skipping build&quot;fi               chmod +x root/.git/hooks/pre-push        Add your new files and recompile by doing a push in root.  EndIf anything is unclear or not working don’t hesitate to leave a comment (if it works).">
    <meta itemprop="datePublished" content="2021-01-24T00:00:00+01:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Automating jekyll build and github hosting
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#backstory">Backstory</a></li><li><a href="#googling-a-solution">Googling a solution</a></li><li><a href="#working-out-the-details">Working out the details</a><ul><li><a href="#separating-by-branching">Separating by branching</a></li><li><a href="#script-for-updating">Script for updating</a></li></ul></li><li><a href="#end">End</a></li></ul>

            </nav>
          </aside>
        
        <h1 id="backstory">Backstory</h1>

<p>As people might have noticed this website runs on jekyll, which is code that creates static websites. Great for my simple blogging use. The easiest way for me to get <a href="https://mmistakes.github.io/minimal-mistakes/">this</a> nice skin working on github pages was to use their remote theme function. However, letting github compile the website leads to some limitation such as plugin use. In order to futureproof myself (files come and go…) I would rather compile it locally and make only use of github’s free hosting.</p>

<h1 id="googling-a-solution">Googling a solution</h1>

<p>Google is my friend, apparently people compile Jekyll locally, mainly for unsupported plugin.  Therefore I searched using the following keywords “Jekyll static github pages with unsupported plugins” and came along <a href="https://tiefenauer.github.io/blog/gh-pages-plugins/">Dani’s</a> nice write-up. Unfortunately, his method on how to update the website didn’t work for me, and is probably due to the lack of my understanding of how git works. I did follow the preceding steps in his guide.  However this lead me to a much better solution which automates a great deal and makes it as easy as a single push of a button ;).  Browsing the internet a bit more I came across <a href="https://surdu.me/2020/02/04/jekyll-git-hook.html">Surdu’s</a> script, which made life easier.</p>

<h1 id="working-out-the-details">Working out the details</h1>

<p>The goal is to enable static webpage hosting on github. And also try to make this as effortless possible.  That is so I can focus my time on my projects and not the nitty gritty.</p>

<p>At the end you will have achieved the following.</p>

<ul>
  <li>Keep files in 1 repository, this makes sense as they belong together</li>
  <li>Store website files in the branch “head”, as github will interpret this to the website files under yourname.github.io</li>
  <li>Store source files in the branch “source”</li>
  <li>Pushing your new posts will recompile the website and update your webpage accordingly</li>
</ul>

<p>I will assume you understand:</p>

<ul>
  <li>Basics of git, at least how to set it. Such you can send git commands in the terminal</li>
  <li>Have jekyll already installed and working. If not see for example <a href="http://sgeos.github.io/jekyll/github/freebsd/2016/01/07/creating-a-jekyll-github-pages-blog-and-managing-it-with-freebsd.html">this.</a></li>
  <li>Basic use of unix</li>
  <li>Use the bundle command to compile your jekyll website</li>
</ul>

<h2 id="separating-by-branching">Separating by branching</h2>

<p>In order for github to correctly interpret your files.  We should push the compiled files (defaults to <code class="language-plaintext highlighter-rouge">_site</code> -inside-) to our head branch. All other files are pushed to our source branch. To achieve this do the following. In your repository folder which is also the main jekyll folder now <code class="language-plaintext highlighter-rouge">root</code>,</p>

<ol>
  <li>Put <code class="language-plaintext highlighter-rouge">_site/</code> in the <code class="language-plaintext highlighter-rouge">.gitignore</code> file</li>
  <li><code class="language-plaintext highlighter-rouge">git checkout source</code>, push and <code class="language-plaintext highlighter-rouge">git checkout master</code>. Compile the website <code class="language-plaintext highlighter-rouge">bundle exec jekyll build</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">cd _site</code> and <code class="language-plaintext highlighter-rouge">touch .nojekyll</code> this prevents github to compile</li>
  <li>Go back to <code class="language-plaintext highlighter-rouge">root</code>, backup all files and remove everything inside except the <code class="language-plaintext highlighter-rouge">.gitignore</code> file.</li>
  <li>Copy everything inside <code class="language-plaintext highlighter-rouge">_site</code> -which you backed up- to <code class="language-plaintext highlighter-rouge">root</code> and push. Delete <code class="language-plaintext highlighter-rouge">_site</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">git checkout sources</code> and copy everything back (not <code class="language-plaintext highlighter-rouge">_site</code>, should be removed) and push. Now github will display your locally compiled website. While your source files are inside the source branch.</li>
</ol>

<p>‘*’ a push entails, easily,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add .
git commit -m 'commit message'
git push
</code></pre></div></div>

<h2 id="script-for-updating">Script for updating</h2>

<p>The complex workflow noted by Dani didn’t work out and I am lazy. So we are going to automate the flow of updating the website and updating our branches accordingly. This script is based on Surdu’s script, but first.</p>

<ol>
  <li>
    <p>Create a file “pre-push” <code class="language-plaintext highlighter-rouge">nano root/.git/hooks/pre-push</code></p>
  </li>
  <li>
    <p>With the following content</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#!/bin/sh
# This script assumes the master branch is the website therefore all compiled files should be in master branch
# the source branch holds all your files, please put &lt;_site/&gt; in your git.ignore file
   
# If any command fails in the below script, exit with error
set -e
   
# Set the name of the folder that will be created in the parent
# folder of your repo folder, and which will temporarily
# hold the generated content.
temp_folder="_source-temp"
   
# Make sure our main code runs only if we push the master branch
if [ "$(git rev-parse --symbolic-full-name --abbrev-ref HEAD)" == "source" ]; then
	# Store the last commit message from source branch
	last_message=$(git show -s --format=%s source)
   
	# Build our Jekyll site
	bundle exec jekyll build
   
	# Move the generated site in our temp folder
	mv _site ../${temp_folder}
   
	# Checkout the gh-pages branch and clean it's contents
	git checkout master
	rm -rf *
   
	# Copy the site content from the temp folder and remove the temp folder
	cp -r ../${temp_folder}/* .
	rm -rf ../${temp_folder}
   
	# Commit and push our generated site to GitHub
	git add -A
	git commit -m "Built \`$last_message\`"
	git push
   
	# Go back to the source branch
	git checkout source
else
	echo "Not source branch. Skipping build"
fi
   
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">chmod +x root/.git/hooks/pre-push</code></p>
  </li>
  <li>
    <p>Add your new files and recompile by doing a push in <code class="language-plaintext highlighter-rouge">root</code>.</p>
  </li>
</ol>

<h1 id="end">End</h1>

<p>If anything is unclear or not working don’t hesitate to leave a comment (if it works).</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#automating" class="page__taxonomy-item" rel="tag">automating</a><span class="sep">, </span>
    
      <a href="/tags/#design" class="page__taxonomy-item" rel="tag">design</a><span class="sep">, </span>
    
      <a href="/tags/#server" class="page__taxonomy-item" rel="tag">server</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#programming" class="page__taxonomy-item" rel="tag">programming</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-01-24T00:00:00+01:00">January 24, 2021</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=Automating+jekyll+build+and+github+hosting%20https%3A%2F%2Fshiko.nl%2Fprogramming%2Fautomating_jekyll%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fshiko.nl%2Fprogramming%2Fautomating_jekyll%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fshiko.nl%2Fprogramming%2Fautomating_jekyll%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/electronics/a-pcb-design/" class="pagination--pager" title="Designing a Nixie HV supply part 1
">Previous</a>
    
    
      <a href="/electronics/designing_business_card/" class="pagination--pager" title="Creating a custom PCB business card with EAGLE
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/programming/pressure_RGB_stairs/" rel="permalink">RGB lights even on your stairs
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          11 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">RGB on stairs that is boring

Is what you might think. But let’s spice it up a bit by making them user aware. Okay, let’s put a motion sensor nearby and this...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/programming/update-ha-2021/" rel="permalink">Can’t update home assistant to latest version because of RUST
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Can’t update home assistant with rust

I kept getting the issue,  error: can’t find Rust compiler on my truenas box. After looking everywhere and trying vari...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/programming/shibee-stick-flash/" rel="permalink">ShiBee stick flashing and teardown
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">To make or not to make a shtick

A recent design of a ZigBee stick

As mentioned before, I had issues with my old ZigBee stick. Also due to low inventory, be...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/programming/espeasy-restart/" rel="permalink">Automatic restart ESP8266 with ESP easy
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">A smart home with issues

Recently, I had the issue where my ZigBee network would die every few days. After a lot of debugging and even re-pairing of all my ...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="search-searchbar"></div>
  <div class="search-hits"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://github.com/shikon" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/lanhu" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> Linkedin</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Lan Hu. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>


<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch-theme-algolia.min.css">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  appId: 'L6XIHWOGZ2',
  apiKey: '43db23cbf486a7a95d34883d3391bdab',
  indexName: 'blog',
  searchParameters: {
    restrictSearchableAttributes: [
      'title',
      'content'
    ]
  }
});

const hitTemplate = function(hit) {
  const url = hit.url;
  const title = hit._highlightResult.title.value;
  const content = hit._highlightResult.html.value;

  return `
    <div class="list__item">
      <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
        <h2 class="archive__item-title" itemprop="headline"><a href="${url}">${title}</a></h2>
        <div class="archive__item-excerpt" itemprop="description">${content}</div>
      </article>
    </div>
  `;
}

// Adding searchbar and results widgets
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '.search-searchbar',
    poweredBy: true,
    placeholder: 'Enter your search term...'
  })
);
search.addWidget(
  instantsearch.widgets.hits({
    container: '.search-hits',
    templates: {
      item: hitTemplate,
      empty: 'No results',
    }
  })
);

// Starting the search only when toggle is clicked
$(document).ready(function () {
  $(".search__toggle").on("click", function() {
    if(!search.started) {
      search.start();
    }
  });
});
</script>









<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" defer
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>


  </body>
</html>
